<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wisdom.iwcs.mapper.system.DictionaryMapper">
    <resultMap id="BaseResultMap" type="com.wisdom.iwcs.domain.system.Dictionary">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Dec 28 11:02:25 CST 2016.
        -->
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="dict_type" property="dictType" jdbcType="VARCHAR"/>
        <result column="dict_type_name" property="dictTypeName" jdbcType="VARCHAR"/>
        <result column="dict_name" property="dictName" jdbcType="VARCHAR"/>
        <result column="dict_value" property="dictValue" jdbcType="VARCHAR"/>
        <result column="sort_code" property="sortCode" jdbcType="INTEGER"/>
        <result column="status" property="status" jdbcType="TINYINT"/>
        <result column="created_by" property="createdBy" jdbcType="INTEGER"/>
        <result column="created_time" property="createdTime" jdbcType="BIGINT"/>
        <result column="last_modified_by" property="lastModifiedBy" jdbcType="INTEGER"/>
        <result column="last_modified_time" property="lastModifiedTime" jdbcType="BIGINT"/>
        <result column="delete_flag" property="deleteFlag" jdbcType="INTEGER"/>
        <result column="judge_type" property="judgeType" jdbcType="VARCHAR"/>

    </resultMap>

    <resultMap id="DictionaryDtoResultMap" type="com.wisdom.iwcs.domain.system.dto.DictionaryDto">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="dict_type" property="dictType" jdbcType="VARCHAR"/>
        <result column="dict_type_name" property="dictTypeName" jdbcType="VARCHAR"/>
        <result column="dict_name" property="dictName" jdbcType="VARCHAR"/>
        <result column="dict_value" property="dictValue" jdbcType="VARCHAR"/>
        <result column="sort_code" property="sortCode" jdbcType="INTEGER"/>
        <result column="status" property="status" jdbcType="TINYINT"/>
        <result column="created_by" property="createdBy" jdbcType="INTEGER"/>
        <result column="created_time" property="createdTime" jdbcType="BIGINT"/>
        <result column="last_modified_by" property="lastModifiedBy" jdbcType="INTEGER"/>
        <result column="last_modified_time" property="lastModifiedTime" jdbcType="BIGINT"/>

        <result column="created_by_str" property="createdByStr"/>
        <result column="last_modified_by_str" property="lastModifiedByStr"/>
    </resultMap>

    <sql id="Base_Column_List">
    a.id, a.dict_type, a.dict_type_name, a.dict_name, a.dict_value, a.sort_code,
    a.status, a.created_by, a.created_time, a.last_modified_by, a.last_modified_time ,a.delete_flag,a.judge_type
  </sql>

    <select id="selectBaseTypeList" resultMap="DictionaryDtoResultMap" parameterType="java.util.Map">
        SELECT A.id, A.dict_type, A.dict_type_name, A.dict_name, A.dict_value, A.sort_code,
        A.status, A.created_by, A.created_time, A.last_modified_by, A.last_modified_time,
        C.user_name AS created_by_str, D.user_name AS last_modified_by_str
        FROM s_dictionary A
        LEFT JOIN s_dictionary B ON A.dict_type = B.dict_type AND A.id &lt; B.id
        LEFT JOIN s_user C ON A.created_by = C.id
        LEFT JOIN s_user D ON A.last_modified_by = D.id
        WHERE B.id IS NULL
        AND A.delete_flag = 1
        <if test="searchKey != null">
            and
            A.dict_type_name LIKE #{searchKey}
        </if>
        <if test="status != null">
            AND A.status = #{status}
        </if>
    </select>

    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        select
        <include refid="Base_Column_List"/>
        from s_dictionary a
        where id = #{id,jdbcType=INTEGER}
    </select>

    <select id="selectAll" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from s_dictionary a
    </select>

    <update id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    UPDATE  s_dictionary
    SET delete_flag = 0
    where id = #{id,jdbcType=INTEGER}
  </update>
    <insert id="insert" parameterType="com.wisdom.iwcs.domain.system.Dictionary" useGeneratedKeys="true"
            keyProperty="id">
    insert into s_dictionary (dict_type, dict_type_name,
      dict_name, dict_value,
      sort_code, status, created_by,
      created_time, last_modified_by, last_modified_time ,delete_flag
      )
    values (#{dictType,jdbcType=VARCHAR}, #{dictTypeName,jdbcType=VARCHAR},
      #{dictName,jdbcType=VARCHAR}, #{dictValue,jdbcType=VARCHAR},
      #{sortCode,jdbcType=INTEGER},
       #{status,jdbcType=TINYINT}, #{createdBy,jdbcType=INTEGER},
    unix_timestamp(now()), #{lastModifiedBy,jdbcType=INTEGER}, unix_timestamp(now()),#{deleteFlag}
      )
  </insert>
    <insert id="insertSelective" parameterType="com.wisdom.iwcs.domain.system.Dictionary" useGeneratedKeys="true"
            keyProperty="id">
        insert into s_dictionary
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="dictType != null">
                dict_type,
            </if>
            <if test="dictTypeName != null">
                dict_type_name,
            </if>
            <if test="dictName != null">
                dict_name,
            </if>
            <if test="dictValue != null">
                dict_value,
            </if>
            <if test="sortCode != null">
                sort_code,
            </if>
            <if test="status != null">
                status,
            </if>
            <if test="createdBy != null">
                created_by,
            </if>
            <if test="createdTime != null">
                created_time,
            </if>
            <if test="lastModifiedBy != null">
                last_modified_by,
            </if>
            <if test="lastModifiedTime != null">
                last_modified_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="dictType != null">
                #{dictType,jdbcType=VARCHAR},
            </if>
            <if test="dictTypeName != null">
                #{dictTypeName,jdbcType=VARCHAR},
            </if>
            <if test="dictName != null">
                #{dictName,jdbcType=VARCHAR},
            </if>
            <if test="dictValue != null">
                #{dictValue,jdbcType=VARCHAR},
            </if>
            <if test="sortCode != null">
                #{sortCode,jdbcType=INTEGER},
            </if>
            <if test="status != null">
                #{status,jdbcType=TINYINT},
            </if>
            <if test="createdBy != null">
                #{createdBy,jdbcType=INTEGER},
            </if>
            <if test="createdTime != null">
                #{createdTime,jdbcType=BIGINT},
            </if>
            <if test="lastModifiedBy != null">
                #{lastModifiedBy,jdbcType=INTEGER},
            </if>
            <if test="lastModifiedTime != null">
                #{lastModifiedTime,jdbcType=BIGINT},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.wisdom.iwcs.domain.system.Dictionary">
        update s_dictionary
        <set>
            <if test="dictType != null">
                dict_type = #{dictType,jdbcType=VARCHAR},
            </if>
            <if test="dictTypeName != null">
                dict_type_name = #{dictTypeName,jdbcType=VARCHAR},
            </if>
            <if test="dictName != null">
                dict_name = #{dictName,jdbcType=VARCHAR},
            </if>
            <if test="dictValue != null">
                dict_value = #{dictValue,jdbcType=VARCHAR},
            </if>
            <if test="sortCode != null">
                sort_code = #{sortCode,jdbcType=INTEGER},
            </if>
            <if test="status != null">
                status = #{status,jdbcType=TINYINT},
            </if>
            <if test="createdBy != null">
                created_by = #{createdBy,jdbcType=INTEGER},
            </if>
            <if test="createdTime != null">
                created_time = #{createdTime,jdbcType=BIGINT},
            </if>
            <if test="lastModifiedBy != null">
                last_modified_by = #{lastModifiedBy,jdbcType=INTEGER},
            </if>
            <if test="lastModifiedTime != null">
                last_modified_time = #{lastModifiedTime,jdbcType=BIGINT},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.wisdom.iwcs.domain.system.Dictionary">
    update s_dictionary
    set dict_type = #{dictType,jdbcType=VARCHAR},
      dict_type_name = #{dictTypeName,jdbcType=VARCHAR},
      dict_name = #{dictName,jdbcType=VARCHAR},
      dict_value = #{dictValue,jdbcType=VARCHAR},
      sort_code = #{sortCode,jdbcType=INTEGER},
      status = #{status,jdbcType=TINYINT},
      created_by = #{createdBy,jdbcType=INTEGER},
      created_time = #{createdTime,jdbcType=BIGINT},
      last_modified_by = #{lastModifiedBy,jdbcType=INTEGER},
      last_modified_time = unix_timestamp(now())
    where id = #{id,jdbcType=INTEGER}
  </update>

    <select id="selectByDictTypePager" resultMap="DictionaryDtoResultMap" parameterType="java.util.Map">
        SELECT aa.* from (
        select
        a.id, a.dict_type, a.dict_type_name, a.dict_name, a.dict_value, a.sort_code,
        a.status, a.created_by, a.created_time, a.last_modified_by, a.last_modified_time,
        b.user_name AS created_by_str ,c.user_name AS last_modified_by_str
        from s_dictionary a
        LEFT JOIN s_user b
        ON a.created_by = b.id
        LEFT JOIN s_user c
        ON a.last_modified_by = c.id
        where 1=1
        AND a.delete_flag = 1
        AND a.dict_type = #{dictType}) aa
        WHERE 1=1
        <if test="searchKey != null">
            and
            aa.dict_name LIKE #{searchKey}
            OR
            aa.dict_value LIKE #{searchKey}
            OR
            aa.sort_code LIKE #{searchKey}
        </if>
        <if test="status != null">
            AND aa.status = #{status}
        </if>
    </select>
    <select id="selectByDictType" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from s_dictionary a
        where 1=1
        AND a.delete_flag = 1
        AND a.status = 1
        <if test="dictType != null">
            AND a.dict_type = #{dictType}
        </if>
    </select>

    <select id="selectByDictName" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from s_dictionary a
        where 1=1
        AND a.delete_flag = 1
        AND a.status = 1
        AND a.dict_name = #{dictName}
    </select>
</mapper>